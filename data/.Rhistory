model_data$PageName[i] =="V39"
){
for(j in 1:220){
#change here
temp[j,k]<-proxy_data[i,j+5]
}
k <- 1+k
cat("finishing ", model_data$PageName[i] )
}
}
#average
for(row in 1:nrow(temp)){
ct <- 0
sum <- 0
for(col in 2:(x+1)){
sum <- sum + temp[row,col]
if(temp[row,col]!=0){
ct <- ct + 1
}
}
if(ct==0){
#change here
temp[row,x+2]<-NA
} else{
temp[row,x+2]<-sum/ct
}
cat("finishing row ", i, "; ")
}
for(i in 1:220){
#change here
proxy_region$w_africa[i]<-temp[i,x+2]
}
# arabean sea P47 and P48
x = 2
#model
#change here
temp <- data.frame(matrix(vector(),220,x+2))
temp$X1 <- seq(100,22000,100)
k <- 2
for(i in 1:nrow(proxy_data)){
if(model_data$PageName[i] == "P47" ||
model_data$PageName[i] =="P48"
){
for(j in 1:220){
temp[j,k]<-model_data[i,j+5]
}
k <- 1+k
cat("finishing ", model_data$PageName[i] )
}
}
#average
for(row in 1:nrow(temp)){
ct <- 0
sum <- 0
#change here
for(col in 2:(x+1)){
sum <- sum + temp[row,col]
if(temp[row,col]!=0){
ct <- ct + 1
}
}
if(ct==0){
temp[row,x+2]<-NA
} else{
temp[row,x+2]<-sum/ct
}
cat("finishing row ", i, "; ")
}
for(i in 1:220){
model_region$arabean_sea[i]<-temp[i,x+2]
}
#proxy
#change here
temp <- data.frame(matrix(vector(),220,x+2))
temp$X1 <- seq(100,22000,100)
k <- 2
for(i in 1:nrow(proxy_data)){
if(model_data$PageName[i] == "P47" ||
model_data$PageName[i] =="P48"
){
for(j in 1:220){
#change here
temp[j,k]<-proxy_data[i,j+5]
}
k <- 1+k
cat("finishing ", model_data$PageName[i] )
}
}
#average
for(row in 1:nrow(temp)){
ct <- 0
sum <- 0
for(col in 2:(x+1)){
sum <- sum + temp[row,col]
if(temp[row,col]!=0){
ct <- ct + 1
}
}
if(ct==0){
#change here
temp[row,x+2]<-NA
} else{
temp[row,x+2]<-sum/ct
}
cat("finishing row ", i, "; ")
}
for(i in 1:220){
#change here
proxy_region$arabean_sea[i]<-temp[i,x+2]
}
# congo T42
x = 1
#model
#change here
temp <- data.frame(matrix(vector(),220,x+2))
temp$X1 <- seq(100,22000,100)
k <- 2
for(i in 1:nrow(proxy_data)){
if(model_data$PageName[i] == "T42"
){
for(j in 1:220){
temp[j,k]<-model_data[i,j+5]
}
k <- 1+k
cat("finishing ", model_data$PageName[i] )
}
}
#average
for(row in 1:nrow(temp)){
ct <- 0
sum <- 0
#change here
for(col in 2:(x+1)){
sum <- sum + temp[row,col]
if(temp[row,col]!=0){
ct <- ct + 1
}
}
if(ct==0){
temp[row,x+2]<-NA
} else{
temp[row,x+2]<-sum/ct
}
cat("finishing row ", i, "; ")
}
for(i in 1:220){
model_region$congo[i]<-temp[i,x+2]
}
#proxy
#change here
temp <- data.frame(matrix(vector(),220,x+2))
temp$X1 <- seq(100,22000,100)
k <- 2
for(i in 1:nrow(proxy_data)){
if(model_data$PageName[i] == "T42"
){
for(j in 1:220){
#change here
temp[j,k]<-proxy_data[i,j+5]
}
k <- 1+k
cat("finishing ", model_data$PageName[i] )
}
}
#average
for(row in 1:nrow(temp)){
ct <- 0
sum <- 0
for(col in 2:(x+1)){
sum <- sum + temp[row,col]
if(temp[row,col]!=0){
ct <- ct + 1
}
}
if(ct==0){
#change here
temp[row,x+2]<-NA
} else{
temp[row,x+2]<-sum/ct
}
cat("finishing row ", i, "; ")
}
for(i in 1:220){
#change here
proxy_region$congo[i]<-temp[i,x+2]
}
# china L59
x = 1
#model
#change here
temp <- data.frame(matrix(vector(),220,x+2))
temp$X1 <- seq(100,22000,100)
k <- 2
for(i in 1:nrow(proxy_data)){
if(model_data$PageName[i] == "L59"
){
for(j in 1:220){
temp[j,k]<-model_data[i,j+5]
}
k <- 1+k
cat("finishing ", model_data$PageName[i] )
}
}
#average
for(row in 1:nrow(temp)){
ct <- 0
sum <- 0
#change here
for(col in 2:(x+1)){
sum <- sum + temp[row,col]
if(temp[row,col]!=0){
ct <- ct + 1
}
}
if(ct==0){
temp[row,x+2]<-NA
} else{
temp[row,x+2]<-sum/ct
}
cat("finishing row ", i, "; ")
}
for(i in 1:220){
model_region$china[i]<-temp[i,x+2]
}
#proxy
#change here
temp <- data.frame(matrix(vector(),220,x+2))
temp$X1 <- seq(100,22000,100)
k <- 2
for(i in 1:nrow(proxy_data)){
if(model_data$PageName[i] == "L59"
){
for(j in 1:220){
#change here
temp[j,k]<-proxy_data[i,j+5]
}
k <- 1+k
cat("finishing ", model_data$PageName[i] )
}
}
#average
for(row in 1:nrow(temp)){
ct <- 0
sum <- 0
for(col in 2:(x+1)){
sum <- sum + temp[row,col]
if(temp[row,col]!=0){
ct <- ct + 1
}
}
if(ct==0){
#change here
temp[row,x+2]<-NA
} else{
temp[row,x+2]<-sum/ct
}
cat("finishing row ", i, "; ")
}
for(i in 1:220){
#change here
proxy_region$china[i]<-temp[i,x+2]
}
# s australia Z64
x = 1
#model
#change here
temp <- data.frame(matrix(vector(),220,x+2))
temp$X1 <- seq(100,22000,100)
k <- 2
for(i in 1:nrow(proxy_data)){
if(model_data$PageName[i] == "Z64"
){
for(j in 1:220){
temp[j,k]<-model_data[i,j+5]
}
k <- 1+k
cat("finishing ", model_data$PageName[i] )
}
}
#average
for(row in 1:nrow(temp)){
ct <- 0
sum <- 0
#change here
for(col in 2:(x+1)){
sum <- sum + temp[row,col]
if(temp[row,col]!=0){
ct <- ct + 1
}
}
if(ct==0){
temp[row,x+2]<-NA
} else{
temp[row,x+2]<-sum/ct
}
cat("finishing row ", i, "; ")
}
for(i in 1:220){
model_region$s_australia[i]<-temp[i,x+2]
}
#proxy
#change here
temp <- data.frame(matrix(vector(),220,x+2))
temp$X1 <- seq(100,22000,100)
k <- 2
for(i in 1:nrow(proxy_data)){
if(model_data$PageName[i] == "Z64"
){
for(j in 1:220){
#change here
temp[j,k]<-proxy_data[i,j+5]
}
k <- 1+k
cat("finishing ", model_data$PageName[i] )
}
}
#average
for(row in 1:nrow(temp)){
ct <- 0
sum <- 0
for(col in 2:(x+1)){
sum <- sum + temp[row,col]
if(temp[row,col]!=0){
ct <- ct + 1
}
}
if(ct==0){
#change here
temp[row,x+2]<-NA
} else{
temp[row,x+2]<-sum/ct
}
cat("finishing row ", i, "; ")
}
for(i in 1:220){
#change here
proxy_region$s_australia[i]<-temp[i,x+2]
}
# S atlantic X39, AA38 and AB38
x = 3
#model
#change here
temp <- data.frame(matrix(vector(),220,x+2))
temp$X1 <- seq(100,22000,100)
k <- 2
for(i in 1:nrow(proxy_data)){
if(model_data$PageName[i] == "X39" ||
model_data$PageName[i] =="AA38" ||
model_data$PageName[i] =="AB38"
){
for(j in 1:220){
temp[j,k]<-model_data[i,j+5]
}
k <- 1+k
cat("finishing ", model_data$PageName[i] )
}
}
#average
for(row in 1:nrow(temp)){
ct <- 0
sum <- 0
#change here
for(col in 2:(x+1)){
sum <- sum + temp[row,col]
if(temp[row,col]!=0){
ct <- ct + 1
}
}
if(ct==0){
temp[row,x+2]<-NA
} else{
temp[row,x+2]<-sum/ct
}
cat("finishing row ", i, "; ")
}
for(i in 1:220){
model_region$s_atlantic[i]<-temp[i,x+2]
}
#proxy
#change here
temp <- data.frame(matrix(vector(),220,x+2))
temp$X1 <- seq(100,22000,100)
k <- 2
for(i in 1:nrow(proxy_data)){
if(model_data$PageName[i] == "X39" ||
model_data$PageName[i] =="AA38" ||
model_data$PageName[i] =="AB38"
){
for(j in 1:220){
#change here
temp[j,k]<-proxy_data[i,j+5]
}
k <- 1+k
cat("finishing ", model_data$PageName[i] )
}
}
#average
for(row in 1:nrow(temp)){
ct <- 0
sum <- 0
for(col in 2:(x+1)){
sum <- sum + temp[row,col]
if(temp[row,col]!=0){
ct <- ct + 1
}
}
if(ct==0){
#change here
temp[row,x+2]<-NA
} else{
temp[row,x+2]<-sum/ct
}
cat("finishing row ", i, "; ")
}
for(i in 1:220){
#change here
proxy_region$s_atlantic[i]<-temp[i,x+2]
}
write.csv(proxy_region,"proxy_region.csv")
write.csv(model_region,"model_region.csv")
library(readr)
library(ggplot2)
proxy <- read_csv("proxy_region.csv")
model <- read_csv("model_region.csv")
diff <- read_csv("../regional_all.csv")
diff <- model - proxy
diff <- data.frame(matrix(vector(), 220, 22))
diff <- data.frame(matrix(vector(), 225, 2592))
diff <- data.frame(matrix(vector(), 220, 23))
for(row in 1:220){
for(col in 2:23){
diff[row,col] <- model[row,col] - proxy[row,col]
}
}
View(diff)
View(model_anomaly_result)
View(model)
diff <- data.frame(matrix(vector(), 220, 23, dimnames=list(
c(),
c("X1",
"time",
"new_zealand",
"greenland",
"n_atlantic",
"s_atlantic",
"indonesia",
"japan",
"oregon",
"alaska",
"china",
"congo",
"mediterranean",
"antarctica",
"arabean_sea",
"gulf_of_mexico",
"e_pacific",
"s_australia",
"philippines",
"s_america",
"iceland",
"scandinavia",
"w_africa"
)
))
)
for(row in 1:220){
for(col in 3:23){
diff[row,col] <- model[row,col] - proxy[row,col]
}
}
for(row in 1:220){
for(col in 3:23){
diff[row,col] <- as.numeric(model[row,col]) - as.numeric(proxy[row,col])
}
}
View(diff)
View(model)
View(proxy)
View(proxy)
library(ggplot2)
library(ggmap)
library(maps)
library(mapdata)
library(geojsonio)
library(broom)
library(maptools)
library(rgdal)
library(readr)
library(RColorBrewer)
library(gtable)
library(grid)
library(dplyr)
require(gridExtra)
library(ggpubr)
model_anomaly <- read_csv("Feng_model_anomaly.csv")
proxy_anomaly <- read_csv("raw_data_anomaly_cal.csv")
library(plyr)
library(readr)
model_anomaly <- read_csv("Feng_model_anomaly.csv")
proxy_anomaly <- read_csv("raw_data_anomaly_cal.csv")
diff_anomaly <- proxy_anomaly
for(row in 1:nrow(model_anomaly)){
for(col in 7:ncol(model_anomaly)){
if(as.numeric(proxy_anomaly[row,col])!= 0 || is.na(proxy_anomaly[row,col])!= 0){
diff_anomaly[row,col] <- as.numeric(model_anomaly[row,col]) - as.numeric(proxy_anomaly[row,col])
} else {
diff_anomaly[row,col] <- NA
}
}
cat("finishing row", row, " ;")
}
write.csv(diff_anomaly, file = "data_model_anomaly_diff.csv")
